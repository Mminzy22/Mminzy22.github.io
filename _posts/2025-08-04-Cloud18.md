---
title: "AWS ëª¨ë‹ˆí„°ë§ â€” CloudWatchÂ·Logs InsightsÂ·ëŒ€ì‹œë³´ë“œÂ·ì•ŒëŒÂ·EventBridgeÂ·SSMÂ·SNS"
author: mminzy22
date: 2025-08-04 21:00:00 +0900
categories: [AWS, Cloud]
tags: [TIL, Cloud-ops, CloudWatch, LogsInsights, Dashboard, Alarm, EventBridge, SSM, SNS, ECS, Lambda]
description: "CloudWatch í•µì‹¬ ê°œë…ë¶€í„° ë©”íŠ¸ë¦­Â·ë¡œê·¸Â·ì¸ì‚¬ì´íŠ¸Â·ëŒ€ì‹œë³´ë“œÂ·ì•ŒëŒÂ·ì´ë²¤íŠ¸, SSM Agent ì„¤ì¹˜ì™€ IAM, SNS ì—°ë™ê¹Œì§€ ì •ë¦¬"
pin: false
mermaid: true
---

> ì´ ê¸€ì€ AWS ê´€ì¸¡ì„±(Observability)ì˜ 3ìš”ì†Œ **MetricsÂ·LogsÂ·Traces** ì¤‘ CloudWatchê°€ ë‹´ë‹¹í•˜ëŠ” **Metrics/Logs**ì™€, ìš´ì˜ ìë™í™”ë¥¼ ìœ„í•œ **AlarmsÂ·EventBridgeÂ·SNS**, ë¬´ì—ì´ì „íŠ¸ ì›ê²©ì ‘ì†ì„ ì§€ì›í•˜ëŠ” **SSM Agent**ê¹Œì§€ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤. (ì˜ˆì‹œëŠ” ì„œìš¸ ë¦¬ì „ `ap-northeast-2` ê¸°ì¤€)

---

# CloudWatch í•µì‹¬ ê°œë…

| êµ¬ì„± ìš”ì†Œ                 | ì„¤ëª…                                                              |
| --------------------- | --------------------------------------------------------------- |
| **Metric (ì§€í‘œ)**       | ë¦¬ì†ŒìŠ¤ì—ì„œ ìˆ˜ì§‘ëœ ìˆ˜ì¹˜ ë°ì´í„° (ì˜ˆ: CPU ì‚¬ìš©ë¥ , ë©”ëª¨ë¦¬, ë„¤íŠ¸ì›Œí¬ ë“±)                      |
| **Log (ë¡œê·¸)**          | ì• í”Œë¦¬ì¼€ì´ì…˜, Lambda, VPC Flow Logs, API Gateway ë“±ì—ì„œ ìˆ˜ì§‘ë˜ëŠ” í…ìŠ¤íŠ¸/JSON ë¡œê·¸ |
| **Dashboard**         | ì»¤ìŠ¤í…€ ì‹œê°í™” ë„êµ¬ â€” ì—¬ëŸ¬ ë©”íŠ¸ë¦­ì„ í•œëˆˆì— ëª¨ë‹ˆí„°ë§                                   |
| **Alarm (ê²½ë³´)**        | íŠ¹ì • ì¡°ê±´ ì¶©ì¡± ì‹œ ê²½ë³´ ìƒì„± â†’ ì•Œë¦¼ ë˜ëŠ” ìë™ ì¡°ì¹˜ (ì˜ˆ: Auto Scaling)                |
| **Insights**          | ë¡œê·¸ë¥¼ ì¿¼ë¦¬ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì„ (CloudWatch Logs Insights)                       |
| **Event (ì´ë²¤íŠ¸)**       | ë¦¬ì†ŒìŠ¤ ìƒíƒœ ë³€í™”, ìŠ¤ì¼€ì¤„ ë“±ì„ ê°ì§€í•´ ëŒ€ì‘ (EventBridge/CloudWatch Events)        |
| **Anomaly Detection** | ë¨¸ì‹ ëŸ¬ë‹ ê¸°ë°˜ ë¹„ì •ìƒ íŒ¨í„´ ê°ì§€ë¡œ ì˜¤íƒ ì¤„ì´ê¸°                                       |

> ğŸ’¡ **Tip**: ë©”íŠ¸ë¦­ì€ ì •ëŸ‰, ë¡œê·¸ëŠ” ì •ì„±. **ë©”íŠ¸ë¦­ìœ¼ë¡œ ê°ì§€í•˜ê³ , ë¡œê·¸ë¡œ ì›ì¸ íŒŒì•…**í•˜ëŠ” íë¦„ì„ í‘œì¤€ìœ¼ë¡œ ë§Œë“œì„¸ìš”.

---

# ì£¼ìš” ê¸°ëŠ¥

## 1) ì§€í‘œ ìˆ˜ì§‘ ë° ì‹œê°í™” (Metrics)

* **EC2, RDS, S3, Lambda, ALB, ECS** ë“± ëŒ€ë¶€ë¶„ì˜ ì„œë¹„ìŠ¤ì™€ í†µí•©
* ê¸°ë³¸ ì§€í‘œ ì™¸ **Custom Metrics**(ì• í”Œë¦¬ì¼€ì´ì…˜ ì§€í‘œ) ì „ì†¡ ê°€ëŠ¥
* ì§‘ê³„(Avg/Max/Min/Sum), ê¸°ê°„(1ë¶„/5ë¶„/10ì´ˆ ë“±) ì„¤ì •
* **Metric Math**ë¡œ ì§€í‘œ ê°„ ì—°ì‚° (ì˜ˆ: `5xxRate = Sum(HTTP5xx)/Sum(RequestCount)`)

## 2) ë¡œê·¸ ìˆ˜ì§‘ ë° ë¶„ì„ (Logs)

* ì†ŒìŠ¤: EC2(CloudWatch Agent), Lambda, ECS/EKS, API Gateway, VPC Flow Logs ë“±
* **Log Group / Log Stream** ê³„ì¸µ êµ¬ì¡°, **ë³´ì¡´ê¸°ê°„(Retention)** ì„¤ì • í•„ìˆ˜
* í•„í„° íŒ¨í„´, êµ¬ë… í•„í„°(ì‹¤ì‹œê°„ íŒŒì´í”„ë¼ì¸), ì§€í‘œ í•„í„°(ë¡œê·¸â†’ë©”íŠ¸ë¦­ ë³€í™˜)

## 3) ë¡œê·¸ ì¸ì‚¬ì´íŠ¸ (CloudWatch Logs Insights)

SQL ìœ ì‚¬ ë¬¸ë²•ìœ¼ë¡œ ëŒ€ê·œëª¨ ë¡œê·¸ë¥¼ ë¹ ë¥´ê²Œ ì¿¼ë¦¬/ì§‘ê³„/ì‹œê°í™”í•©ë‹ˆë‹¤.

```sql
-- ìµœê·¼ 20ê±´
fields @timestamp, @message
| sort @timestamp desc
| limit 20
```

```sql
-- ERROR í‚¤ì›Œë“œ í¬í•¨ ë¡œê·¸ 50ê±´
fields @timestamp, @message
| filter @message like /ERROR/
| sort @timestamp desc
| limit 50
```

```sql
-- 1ì‹œê°„ ë‹¨ìœ„ ì´ë²¤íŠ¸ ìˆ˜
stats count(*) as cnt by bin(1h)
```

```sql
-- JSON ë¡œê·¸ì—ì„œ statusCodeë³„ ì¹´ìš´íŠ¸
parse @message /\"statusCode\":(?<status>\d+)/
| stats count(*) as c by status
| sort c desc
```

```sql
-- p95 ì§€ì—°ì‹œê°„ (ms)
fields latency
| filter ispresent(latency)
| stats pct(latency,95) as p95, avg(latency) as avg by bin(5m)
```

> **êµ¬ì¡°ì (JSON) ë¡œê¹…**ì„ ê¶Œì¥í•©ë‹ˆë‹¤. íŒŒì‹± ì—†ì´ `fields status, path, latency`ì²˜ëŸ¼ ì¦‰ì‹œ ë¶„ì„ ê°€ëŠ¥.

## 4) ê²½ë³´ ì„¤ì • (Alarms)

* ì˜ˆ: CPUUtilization > 80% **5ë¶„ ì—°ì†** â†’ `ALARM`
* ì•¡ì…˜: **SNS ì•Œë¦¼**, **Auto Scaling**, **EC2 ì¬ë¶€íŒ…**, **Systems Manager Automation** ë“±
* **Composite Alarm**ìœ¼ë¡œ ë‹¤ì¤‘ ì¡°ê±´ ê²°í•©, **Anomaly Detection**ìœ¼ë¡œ ë¹„ì •ìƒ íŒ¨í„´ ìë™ ì¶”ì 

## 5) ëŒ€ì‹œë³´ë“œ (Dashboard)

* ì—¬ëŸ¬ ì„œë¹„ìŠ¤ ì§€í‘œë¥¼ í•œ í™”ë©´ì— ì‹œê°í™” (ë¼ì¸/ìŠ¤íƒ/ê²Œì´ì§€/ìˆ˜ì¹˜/í…ìŠ¤íŠ¸ ë“±)
* ëŒ€ì‹œë³´ë“œ JSON(Infra as Code)ë¡œ ë‚´ë³´ë‚´ê¸°/ë²„ì „ ê´€ë¦¬ ê¶Œì¥

## 6) ì´ë²¤íŠ¸ ëŒ€ì‘ (EventBridge)

* ì¼ì •/ìƒíƒœ ë³€í™”/ì„œë¹„ìŠ¤ ì´ë²¤íŠ¸ â†’ **Lambda/SQS/SNS/Step Functions** íŠ¸ë¦¬ê±°
* ì˜ˆ: `ECS Service Deployment State Change` â†’ ìŠ¬ë™ ì•Œë¦¼

---

# ëŒ€ì‹œë³´ë“œ ë§Œë“¤ê¸°

## ë°©ë²• â‘  ì½˜ì†”

1. **CloudWatch â†’ Dashboards â†’ \[Create dashboard]**
2. ì´ë¦„ ì˜ˆ: `Prod-Monitoring`
3. ìœ„ì ¯(Line/Number/Gauge/Stacked Area/Text ë“±) ì„ íƒ â†’ **Configure**ì—ì„œ ë©”íŠ¸ë¦­ ì§€ì •

## ë°©ë²• â‘¡ JSON(IaC)

ëŒ€ì‹œë³´ë“œë¥¼ ì½”ë“œë¡œ ê´€ë¦¬í•˜ë©´ ì¬í˜„/ë³µêµ¬ê°€ ì‰¬ì›Œì§‘ë‹ˆë‹¤.

```json
{
  "widgets": [
    {
      "type": "metric",
      "width": 12,
      "height": 6,
      "properties": {
        "metrics": [
          [ "AWS/EC2", "CPUUtilization", "InstanceId", "i-0123456789abcdef0" ]
        ],
        "stat": "Average",
        "period": 60,
        "title": "EC2 CPU Avg (1m)"
      }
    }
  ]
}
```

```bash
# ì ìš© (ëŒ€ì‹œë³´ë“œ ì´ë¦„: Prod-Monitoring)
aws cloudwatch put-dashboard \
  --dashboard-name Prod-Monitoring \
  --dashboard-body file://dashboard.json
```

### ìœ„ì ¯ ì¶”ì²œ ì˜ˆì‹œ

| ëª©ì             | ìœ„ì ¯ ì„¤ì •                                                           |
| ------------- | --------------------------------------------------------------- |
| **EC2 CPU**   | Line â†’ `AWS/EC2` â†’ `CPUUtilization`(Per-Instance)               |
| **Lambda ì˜¤ë¥˜** | Number â†’ `AWS/Lambda` â†’ `Errors`                                |
| **RDS ì—°ê²° ìˆ˜**  | Gauge â†’ `AWS/RDS` â†’ `DatabaseConnections`                       |
| **ECS ìš”ì²­ ìˆ˜**  | Stacked Area â†’ `AWS/ApplicationELB` â†’ `RequestCount`(Target ê¸°ì¤€) |

---

# ì•ŒëŒ(Alarm) â€” ë§Œë“¤ê³ , ì—°ê²°í•˜ê³ , ìë™í™”í•˜ê¸°

## 1) ê¸°ë³¸ ì•ŒëŒ (CLI)

```bash
aws cloudwatch put-metric-alarm \
  --alarm-name ec2-high-cpu \
  --metric-name CPUUtilization \
  --namespace AWS/EC2 \
  --statistic Average \
  --period 60 \
  --threshold 80 \
  --comparison-operator GreaterThanThreshold \
  --evaluation-periods 5 \
  --dimensions Name=InstanceId,Value=i-0123456789abcdef0 \
  --alarm-actions arn:aws:sns:ap-northeast-2:111122223333:ops-alerts
```

## 2) ì´ìƒíƒì§€(Anomaly Detection) ì•ŒëŒ

```bash
aws cloudwatch put-anomaly-detector \
  --metric-name RequestCount \
  --namespace AWS/ApplicationELB \
  --statistic Sum \
  --dimensions Name=LoadBalancer,Value=app/my-alb/abc

aws cloudwatch put-metric-alarm \
  --alarm-name alb-req-anomaly \
  --comparison-operator GreaterThanUpperThreshold \
  --threshold-metric-id ad1 \
  --evaluation-periods 3 \
  --metrics '[
    {"Id":"m1","MetricStat":{"Metric":{"Namespace":"AWS/ApplicationELB","MetricName":"RequestCount","Dimensions":[{"Name":"LoadBalancer","Value":"app/my-alb/abc"}]},"Period":60,"Stat":"Sum"}},
    {"Id":"ad1","Expression":"ANOMALY_DETECTION_BAND(m1, 2)","Label":"anomaly-band","ReturnData":true}
  ]' \
  --alarm-actions arn:aws:sns:ap-northeast-2:111122223333:ops-alerts
```

## 3) í•©ì„±(Composite) ì•ŒëŒ ì˜ˆì‹œ

* ì¡°ê±´: **CPU>80%** **AND** **5xxRate>1%** ì¼ ë•Œë§Œ ì•Œë¦¼
* ê°œë³„ ì•ŒëŒ 2ê°œë¥¼ ë§Œë“¤ê³ , Composite ì•ŒëŒì—ì„œ `ALARM(ALARM1) AND ALARM(ALARM2)` í‘œí˜„ì‹ ì‚¬ìš©

---

# EventBridge â€” ì•ŒëŒê³¼ ì´ë²¤íŠ¸ë¥¼ ìë™í™”ë¡œ ì—°ê²°

```json
{
  "source": ["aws.cloudwatch"],
  "detail-type": ["CloudWatch Alarm State Change"],
  "detail": {
    "state": { "value": ["ALARM"] },
    "alarmName": ["ec2-high-cpu"]
  }
}
```

ì´ ê·œì¹™ìœ¼ë¡œ **Lambda, SNS, SQS, ChatOps(ìŠ¬ë™ ì›¹í›…)** ë“±ì„ í˜¸ì¶œí•´ **ìë™ ë¡¤ë°±/ì¹˜ë£Œ** ë˜ëŠ” **í’ë¶€í•œ ì•Œë¦¼**ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

```bash
aws events put-rule \
  --name on-alarm-ec2-cpu \
  --event-pattern file://rule.json

aws events put-targets \
  --rule on-alarm-ec2-cpu \
  --targets 'TargetId'='notify',"Arn"='arn:aws:sns:ap-northeast-2:111122223333:ops-alerts'
```

---

# Logs Insights â€” í˜„ì—…ì—ì„œ ë°”ë¡œ ì“°ëŠ” ì¿¼ë¦¬ ëª¨ìŒ

## 1) ì—ëŸ¬ ë¹„ìœ¨(ë¶„ ë‹¨ìœ„)

```sql
fields @timestamp, @message
| parse @message /\"status\":(?<status>\d+)/
| stats sum(if(status >= 500, 1, 0)) as e, count(*) as t by bin(1m)
| display (e*100.0/t) as error_rate
```

## 2) ê°€ì¥ ëŠë¦° ì—”ë“œí¬ì¸íŠ¸ Top 10

```sql
fields path, latency
| filter ispresent(path) and ispresent(latency)
| stats pct(latency,95) as p95 by path
| sort p95 desc
| limit 10
```

## 3) ECS JSON ë¡œê·¸ íŒŒì‹± ì˜ˆì‹œ

```sql
fields @timestamp, @message
| parse @message /\"level\":\"(?<level>\w+)\",\"msg\":\"(?<msg>.*?)\",\"traceId\":\"(?<trace>.*?)\"/
| filter level in ["ERROR","WARN"]
| sort @timestamp desc
| limit 50
```

> âš ï¸ **ë¹„ìš© ì£¼ì˜**: Logs InsightsëŠ” **ìŠ¤ìº”í•œ ë°”ì´íŠ¸** ê¸°ì¤€ ê³¼ê¸ˆ. **ì‹œê°„ ë²”ìœ„ ì¶•ì†Œ + êµ¬ì²´ì  í•„í„° + í•„ìš”í•œ í•„ë“œë§Œ** ì¶œë ¥í•˜ì„¸ìš”.

---

# CloudWatch Agent â€” OS ë©”íŠ¸ë¦­/ë¡œê·¸ ìˆ˜ì§‘

EC2ì— CloudWatch Agentë¥¼ ì„¤ì¹˜í•˜ë©´ ë©”ëª¨ë¦¬/ë””ìŠ¤í¬ ë“± **OS ë ˆë²¨ ë©”íŠ¸ë¦­**ê³¼ **ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸**ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`/opt/aws/amazon-cloudwatch-agent/bin/config.json` ì˜ˆì‹œ:

```json
{
  "metrics": {
    "append_dimensions": { "InstanceId": "${aws:InstanceId}" },
    "aggregation_dimensions": [["InstanceId"]],
    "metrics_collected": {
      "mem": { "measurement": ["mem_used_percent"], "metrics_collection_interval": 60 },
      "disk": { "measurement": ["used_percent"], "resources": ["*"], "metrics_collection_interval": 60 }
    }
  },
  "logs": {
    "logs_collected": {
      "files": {
        "collect_list": [
          {"file_path": "/var/log/messages", "log_group_name": "/ec2/messages", "log_stream_name": "{instance_id}"}
        ]
      }
    }
  }
}
```

ì ìš©:

```bash
sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl \
  -a fetch-config -m ec2 -c file:/opt/aws/amazon-cloudwatch-agent/bin/config.json -s
```

---

# SSM Agent â€” SSH ì—†ì´ë„ ìš´ì˜í•˜ëŠ” ë²•

## 1) SSM Agentë€?

EC2ì™€ **AWS Systems Manager** ê°„ í†µì‹ ì„ ë‹´ë‹¹í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´.

* **Run Command**(ì›ê²© ëª…ë ¹), **Session Manager**(ë¸Œë¼ìš°ì €/CLI ì…¸), **Patch/Inventory**, **ìë™í™”** ë“±ì„ ì§€ì›í•©ë‹ˆë‹¤.

## 2) Amazon Linux 2023 â€” ì„¤ì¹˜/í™•ì¸

```bash
# ìƒíƒœ í™•ì¸
systemctl status amazon-ssm-agent

# ì„¤ì¹˜
sudo dnf install -y amazon-ssm-agent

# ë¶€íŒ… ìë™ì‹œì‘ + ì¦‰ì‹œ ì‹œì‘
sudo systemctl enable amazon-ssm-agent
sudo systemctl start amazon-ssm-agent
```

## 3) IAM Role

* EC2 ì¸ìŠ¤í„´ìŠ¤ í”„ë¡œíŒŒì¼ì— **`AmazonSSMManagedInstanceCore`** í•„ìˆ˜
* CloudWatch Agent ì—°ë™ ì‹œ **`CloudWatchAgentServerPolicy`** ì¶”ê°€

ì—­í•  ì ìš© í›„ ë¬¸ì œ ì‹œ:

```bash
sudo systemctl restart amazon-ssm-agent
```

## 4) (ì„ íƒ) í”„ë¼ì´ë¹— ì „ìš© êµ¬ì„±

ì¸í„°ë„· ì—†ì´ ì‚¬ìš©í•˜ë ¤ë©´ **VPC ì—”ë“œí¬ì¸íŠ¸(Interface)**ë¥¼ ìƒì„±í•˜ì„¸ìš”:

* `com.amazonaws.ap-northeast-2.ssm`
* `com.amazonaws.ap-northeast-2.ec2messages`
* `com.amazonaws.ap-northeast-2.ssmmessages`
* (CloudWatch/Logs/KMSë„ í•„ìš” ì‹œ ì¶”ê°€)

> ì„¸ì…˜ ë¡œê·¸ëŠ” **S3/CloudWatch Logs**ë¡œ ì•„ì¹´ì´ë¹™(SSM ì„¤ì •)í•˜ë©´ ì¶”ì ì„±ì´ ì¢‹ì•„ì§‘ë‹ˆë‹¤.

---

# SNS â€” ì•ŒëŒê³¼ ì‚¬ëŒ/ì‹œìŠ¤í…œì„ ì‡ëŠ” í—ˆë¸Œ

## ì£¼ìš” ê°œë…

* **Topic**: ë©”ì‹œì§€ ë°œí–‰/êµ¬ë…ì˜ ë…¼ë¦¬ ì±„ë„
* **Pub/Sub**: Publisherê°€ Topicì— ê²Œì‹œ â†’ ëª¨ë“  Subscriberê°€ ìˆ˜ì‹ 
* **êµ¬ë…ì ìœ í˜•**: Email, SMS, HTTP(S), **SQS**, **Lambda**, ëª¨ë°”ì¼ í‘¸ì‹œ ë“±
* **í•„í„° ì •ì±…**: ë©”ì‹œì§€ ì†ì„±ìœ¼ë¡œ êµ¬ë…ìë³„ ì„ ë³„ ìˆ˜ì‹ 
* **ì•”í˜¸í™”**: KMS ê¸°ë°˜ at-rest ì•”í˜¸í™”, HTTPS/TLS in-transit
* **FIFO Topic**(ì •í™•íˆ í•œ ë²ˆ, ìˆœì„œ ë³´ì¥) ì§€ì›

## ì‚¬ìš© ì˜ˆ â€” ì£¼ë¬¸ ì²˜ë¦¬/ìš´ì˜ ì•Œë¦¼

* Topic: `ops-alerts`
* êµ¬ë…ì: Slack Webhook Lambda, on-call SMS, SQS(í›„ì† ì²˜ë¦¬)
* CloudWatch Alarm/EventBridge â†’ **SNS Publish**ë¡œ ì—°ê²°

## CLI ë¹ ë¥¸ ì‹œì‘

```bash
# í† í”½ ìƒì„±
aws sns create-topic --name ops-alerts

# ì´ë©”ì¼ êµ¬ë…
aws sns subscribe \
  --topic-arn arn:aws:sns:ap-northeast-2:111122223333:ops-alerts \
  --protocol email --notification-endpoint you@example.com

# ë°œí–‰
aws sns publish \
  --topic-arn arn:aws:sns:ap-northeast-2:111122223333:ops-alerts \
  --message '{"service":"api","severity":"CRITICAL","msg":"5xx spike"}' \
  --message-attributes '{"severity":{"DataType":"String","StringValue":"CRITICAL"}}'
```

## Java ì˜ˆì‹œ (SDK v2)

```groovy
// build.gradle
implementation 'software.amazon.awssdk:sns:2.25.4'
```

```java
import software.amazon.awssdk.auth.credentials.DefaultCredentialsProvider;
import software.amazon.awssdk.regions.Region;
import software.amazon.awssdk.services.sns.SnsClient;
import software.amazon.awssdk.services.sns.model.PublishRequest;
import software.amazon.awssdk.services.sns.model.PublishResponse;

public class SnsPushExample {
  public static void main(String[] args) {
    SnsClient sns = SnsClient.builder()
        .region(Region.AP_NORTHEAST_2)
        .credentialsProvider(DefaultCredentialsProvider.create())
        .build();

    String topicArn = "arn:aws:sns:ap-northeast-2:111122223333:ops-alerts";
    String messageJson = "{\n  \"default\": \"ê¸°ë³¸ ë©”ì‹œì§€\",\n  \"GCM\": \"{ \\\"notification\\\": { \\\"title\\\": \\\"ì•Œë¦¼ ì œëª©\\\", \\\"body\\\": \\\"ì•Œë¦¼ ë‚´ìš©\\\" } }\"\n}";

    PublishRequest req = PublishRequest.builder()
        .messageStructure("json")
        .message(messageJson)
        .topicArn(topicArn)
        .build();

    PublishResponse res = sns.publish(req);
    System.out.println("ë©”ì‹œì§€ ì „ì†¡: " + res.messageId());
  }
}
```

> íŒ: **í† í”½ ì •ì±…(Topic Policy)**ìœ¼ë¡œ ë°œí–‰/êµ¬ë… ì£¼ì²´ ì œí•œ, **êµ¬ë… í•„í„° ì •ì±…**ìœ¼ë¡œ ì•Œë¦¼ ê³¼ë‹¤ë¥¼ ì¤„ì´ì„¸ìš”.

---

# ìš”ê¸ˆ ê°œìš” & ìµœì í™” íŒ

| í•­ëª©           | ê³¼ê¸ˆ í¬ì¸íŠ¸              | ì ˆê° íŒ                                          |
| ------------ | ------------------- | --------------------------------------------- |
| **Metrics**  | ì‚¬ìš©ì ì§€ì • ë©”íŠ¸ë¦­ ìˆ˜/ë³´ì¡´     | ë¶ˆí•„ìš” ì§€í‘œ ì œê±°, ì§‘ê³„ ì£¼ê¸° 1â†’5ë¶„ ì™„í™”                      |
| **Logs**     | ìˆ˜ì§‘/ì €ì¥/ì•„ì¹´ì´ë¸Œ/ì¡°íšŒ(ì¸ì‚¬ì´íŠ¸) | ë³´ì¡´ê¸°ê°„ ë‹¨ì¶•, ì•„ì¹´ì´ë¸Œ(S3 Glacier), JSON ì••ì¶•, íŒŒí‹°ì…˜ ê¸°ë°˜ ì¿¼ë¦¬ |
| **Alarms**   | ì•ŒëŒ ê°œìˆ˜/ì£¼ê¸°            | Composite/Anomalyë¡œ ì˜¤íƒ ê°ì†Œ, ì¤‘ë³µ ì•Œë¦¼ ì–µì œ            |
| **Insights** | ìŠ¤ìº” ë°”ì´íŠ¸              | ì‹œê°„ ì°½ ì¶•ì†Œ, êµ¬ì²´ì  í•„í„°/í•„ë“œ ì œí•œ                         |
| **SNS**      | ì „ì†¡ëŸ‰/ëŒ€ìƒ(SMS ë¹„ìŒˆ)      | ì´ë©”ì¼/Slack ìš°ì„ , SMSëŠ” ì„ê³„ì¹˜â†‘/ì˜¨ì½œ ì „ìš©                 |

---

# ì²´í¬ë¦¬ìŠ¤íŠ¸

* [ ] ëŒ€ì‹œë³´ë“œ JSONì„ **Gitì— ë²„ì „ ê´€ë¦¬** (IaC)
* [ ] **Anomaly Detection**ê³¼ **Composite Alarm**ìœ¼ë¡œ ì•Œë¦¼ í’ˆì§ˆ ê°œì„ 
* [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ **êµ¬ì¡°ì (JSON) ë¡œê¹…** ì±„íƒ â†’ Logs Insights ìƒì‚°ì„± â†‘
* [ ] CloudWatch Agentë¡œ **ë©”ëª¨ë¦¬/ë””ìŠ¤í¬** ë©”íŠ¸ë¦­ ì¶”ê°€ ìˆ˜ì§‘
* [ ] **SSM Session Manager** ê¸°ë³¸ ì ‘ì† ê²½ë¡œë¡œ í‘œì¤€í™”(SSH ê¸ˆì§€)
* [ ] EventBridgeë¡œ **ì•ŒëŒâ†’ìë™ ì¹˜ë£Œ/í‹°ì¼“íŒ…** ì—°ê²°
* [ ] ë³´ì¡´ê¸°ê°„Â·ì••ì¶•Â·ì•„ì¹´ì´ë¸Œë¡œ **ë¡œê·¸ ë¹„ìš© ìµœì í™”**

---

# ì „ì²´ íë¦„ë„ (Mermaid)

```mermaid
flowchart LR
  subgraph App
    A[App/Container] --> L[CloudWatch Logs]
    A --> M[CloudWatch Metrics]
  end
  L --> LI[Logs Insights]
  M --> AL[Alarms]
  AL --> EB[EventBridge]
  EB -->|Notify| SNS[(SNS)]
  EB -->|Auto-Heal| Lambda
  SNS --> OnCall[On-call/SMS]
  SNS --> ChatOps[Slack/Email]
  subgraph Ops
    SSM[SSM Session Manager]
  end
  SSM --- App
```

---

# ë§ˆë¬´ë¦¬

CloudWatchÂ·SSMÂ·SNSÂ·EventBridgeë¥¼ ë¬¶ìœ¼ë©´ **ê°ì§€(Detect) â†’ ì§„ë‹¨(Diagnose) â†’ ì•Œë¦¼(Notify) â†’ ì¡°ì¹˜(Remedy)**ì˜ ë£¨í”„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
