---
title: "AInfo ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ê³µì§€ ë©”ì¼ ë³´ë‚´ê¸°"
author: mminzy22
date: 2025-03-21 21:00:00 +0900
categories: [í”„ë¡œì íŠ¸, DRF, AI]
tags: [Bootcamp, TIL, Chatbot, Django, DRF, LangChain, RAG, ChromaDB, Celery, í”„ë¡œì íŠ¸]
description: "Django ê´€ë¦¬ì(admin) í˜ì´ì§€ì—ì„œ Celeryë¥¼ í†µí•´ ì „ì²´ ì‚¬ìš©ìì—ê²Œ ê³µì§€ ë©”ì¼ì„ ë¹„ë™ê¸° ì „ì†¡í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•œ ê³¼ì •ì„ ì •ë¦¬í•©ë‹ˆë‹¤."
pin: false
mermaid: true
---


## ê´€ë¦¬ìë„ ìë™í™”ê°€ í•„ìš”í•œ ì´ìœ 

AInfo í”„ë¡œì íŠ¸ì—ì„œëŠ” ê´€ë¦¬ì(admin)ê°€ ì „ì²´ ì‚¬ìš©ìì—ê²Œ ê³µì§€ ë©”ì¼ì„ ë°œì†¡í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ìˆ˜ì²œ ëª…ì˜ ìœ ì €ì—ê²Œ ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë©”ì¼ì„ ë³´ë‚¼ ê²½ìš°:

- ì„œë²„ê°€ ëŠë ¤ì§€ê³ ,
- ì‘ë‹µì´ ì§€ì—°ë˜ë©°,
- ì‚¬ìš©ì ê²½í—˜ì´ ì €í•˜ë©ë‹ˆë‹¤.

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **Django Admin + Celery + ë¹„ë™ê¸° ë©”ì¼ ë°œì†¡ êµ¬ì¡°**ë¥¼ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.


## êµ¬í˜„ ëª©í‘œ

> **Django ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ë²„íŠ¼ í•œ ë²ˆ í´ë¦­ìœ¼ë¡œ ì „ì²´ ì‚¬ìš©ìì—ê²Œ ê³µì§€ ë©”ì¼ ì „ì†¡**


## ê¸°ëŠ¥ íë¦„ ìš”ì•½

```mermaid
graph TD
A[ê´€ë¦¬ìê°€ ê³µì§€ ì‘ì„±] --> B[Admin í˜ì´ì§€ì— ë²„íŠ¼ ë…¸ì¶œ]
B --> C[ë²„íŠ¼ í´ë¦­ ì‹œ Celery Task í˜¸ì¶œ]
C --> D[ì „ì²´ ì‚¬ìš©ìì—ê²Œ ë©”ì¼ ì „ì†¡]
D --> E[ë°œì†¡ ë‚´ì—­ DBì— ê¸°ë¡]
```


## 1. ê³µì§€ ë©”ì¼ ëª¨ë¸ ì •ì˜ (`notifications/models.py`)

```python
class EmailNotification(models.Model):
    title = models.CharField(max_length=255)
    content = models.TextField()
    sent_at = models.DateTimeField(auto_now_add=True)
    sender = models.CharField(max_length=50, null=True, blank=True)
```

- ì œëª©, ë‚´ìš©, ë°œì†¡ì¼, ë³´ë‚¸ ì‚¬ëŒ(ê´€ë¦¬ì ì´ë¦„)ì„ ì €ì¥í•©ë‹ˆë‹¤.


## 2. Celery Task ì •ì˜ (`notifications/tasks.py`)

```python
@shared_task
def send_mail_to_all(title, content, sender_name):
    users = User.objects.filter(terms_agree=True).values_list("email", flat=True)
    email_messages = [
        (title, content, settings.DEFAULT_FROM_EMAIL, [email])
        for email in users if email
    ]
    send_mass_mail(email_messages, fail_silently=True)

    EmailNotification.objects.create(
        title=title, content=content, sender=sender_name
    )
```

- `terms_agree=True`ì¸ ìœ ì € ëŒ€ìƒìœ¼ë¡œ ë©”ì¼ ì „ì†¡
- ë°œì†¡ ì™„ë£Œ í›„ DBì— ê¸°ë¡


## 3. Django Admin í˜ì´ì§€ì— ë²„íŠ¼ ì¶”ê°€ (`notifications/admin.py`)

```python
class EmailNotificationAdmin(admin.ModelAdmin):
    list_display = ("title", "content", "sent_at", "sender", "send_email_button")
    readonly_fields = ("sent_at",)

    def send_email_button(self, obj):
        return format_html(
            '<a class="button" href="{}">ğŸ’Œ ì „ì²´ìœ ì €ì—ê²Œ ê³µì§€ë©”ì¼ ë³´ë‚´ê¸° ğŸ’Œ</a>',
            self.get_send_email_url(obj),
        )

    def send_email_view(self, request, email_id):
        email_notification = EmailNotification.objects.get(id=email_id)
        email_notification.sender = request.user.name
        email_notification.save()
        send_mail_to_all.delay(
            email_notification.title, email_notification.content, request.user.name
        )
        self.message_user(request, "ğŸ“¨ ê³µì§€ ë©”ì¼ì´ ì „ì²´ ì‚¬ìš©ìì—ê²Œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!")
        return redirect("/admin/notifications/emailnotification/")
```

- ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `send_mail_to_all.delay(...)` í˜¸ì¶œ
- ê´€ë¦¬ì ì´ë¦„ë„ í•¨ê»˜ ê¸°ë¡


## 4. ì‹¤í–‰ ê²°ê³¼

- ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ê³µì§€ ì‘ì„± í›„, ë²„íŠ¼ í•œ ë²ˆìœ¼ë¡œ ì „ì²´ ë°œì†¡ ì™„ë£Œ
- ë¹„ë™ê¸° ì „ì†¡ì´ë¼ ë¹ ë¥´ê²Œ ì‘ë‹µ ë°˜í™˜ë¨
- ë°œì†¡ ë‚´ì—­ì€ Admin í˜ì´ì§€ì—ì„œ í™•ì¸ ê°€ëŠ¥


## ë§ˆë¬´ë¦¬

ì´ ê¸°ëŠ¥ì€ ë‹¨ìˆœí•˜ì§€ë§Œ ê°•ë ¥í•©ë‹ˆë‹¤. **ê´€ë¦¬ìëŠ” ì½”ë“œë¥¼ ëª°ë¼ë„ Django Admin í˜ì´ì§€ì—ì„œ ì „ì²´ ê³µì§€ë¥¼ ë°œì†¡í•  ìˆ˜ ìˆê³ **, Celery ë•ë¶„ì— ì‹œìŠ¤í…œì— ë¶€ë‹´ ì—†ì´ ë¹„ë™ê¸° ì²˜ë¦¬ë©ë‹ˆë‹¤.
